const PDFDocument = require('pdfkit');
const sgMail = require('@sendgrid/mail');
const busboy = require('busboy');

sgMail.setApiKey(process.env.SENDGRID_API_KEY);

function parseMultipartForm(event) {
    return new Promise((resolve) => {
        const fields = {};
        const files = {};
        const bb = busboy({ headers: { 'content-type': event.headers['content-type'] } });
        bb.on('file', (name, stream, info) => {
            const chunks = [];
            stream.on('data', (chunk) => chunks.push(chunk));
            stream.on('end', () => { files[name] = { content: Buffer.concat(chunks), filename: info.filename, contentType: info.mimeType }; });
        });
        bb.on('field', (name, val) => { fields[name] = val; });
        bb.on('close', () => { resolve({ fields, files }); });
        bb.end(Buffer.from(event.body, 'base64'));
    });
}

// --- INICIO DE LA REESCRITURA DEL PDF ---
function generatePdf(data, files) {
    return new Promise((resolve, reject) => {
        const doc = new PDFDocument({ size: 'A4', margin: 30 });
        const buffers = [];

        doc.on('data', buffers.push.bind(buffers));
        doc.on('end', () => resolve(Buffer.concat(buffers)));

        // --- DIBUJANDO EL NUEVO DISEÑO DEL PDF CON PDFKIT ---

        // ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼
        //  INSTRUCCIÓN: Pega la cadena de texto completa del logo en base64 aquí dentro de las comillas.
        //  (La cadena que empieza por "iVBORw0KGgo...")
        const logoEnBase64 = "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";
        // ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲

        try {
            // Convertir el base64 a un Buffer para que PDFKit pueda usarlo
            const logoBuffer = Buffer.from(logoEnBase64, 'base64');

            // Encabezado con fondo amarillo/hueso
            doc.rect(0, 0, doc.page.width, 80).fill('#FFFBEA');

            // Dibujar el logo en ambas esquinas
            doc.image(logoBuffer, 30, 20, { width: 80 });
            doc.image(logoBuffer, doc.page.width - 110, 20, { width: 80 });

            // Título en rojo
            doc.fontSize(18).font('Helvetica-Bold').fillColor('red').text('RECLAMACION DE GARANTÍAS', 0, 40, { align: 'center' });

        } catch (e) {
            console.error("Fallo al cargar el logo desde base64. ¿Está pegado correctamente?", e.message);
            doc.fontSize(10).fillColor('red').text('Error: No se pudo cargar el logo.', 30, 30);
        }

        // Mover la línea separadora debajo del nuevo encabezado
        doc.moveTo(30, 85).lineTo(doc.page.width - 30, 85).stroke();

        // Función para dibujar los campos
        const drawField = (label, value, x, y, labelWidth = 80, valueWidth = 180) => {
            doc.rect(x, y, labelWidth, 20).fillAndStroke('#EFEFEF', '#000000');
            doc.fontSize(10).font('Helvetica-Bold').fillColor('black').text(label, x + 5, y + 6, { lineBreak: false });
            doc.rect(x + labelWidth, y, valueWidth, 20).fillAndStroke('white', '#000000');
            doc.fontSize(10).font('Helvetica').fillColor('black').text(value || '', x + labelWidth + 5, y + 6, { lineBreak: false });
        };
        
        // Coordenada Y inicial para los campos, para dejar espacio al nuevo encabezado
        const startY = 100;

        // Dibujar todos los campos en dos columnas
        drawField('FECHA', data.fecha, 30, startY);
        drawField('CLIENTE', data.cliente, 30, startY + 25);

        drawField('AGENTE', data.agente, 310, startY);
        drawField('CONTACTO', data.contacto, 310, startY + 25);

        drawField('MODELO', data.modelo, 30, startY + 65);
        drawField('REF', data.referencia, 30, startY + 90);
        drawField('TALLA', data.talla, 30, startY + 115);

        // Descripción
        doc.fontSize(9).font('Helvetica-Bold').text('DESCRIPCIÓN DEFECTO', 315, startY + 53);
        doc.rect(310, startY + 65, 255, 70).stroke();
        doc.fontSize(10).font('Helvetica').text(data.motivoReclamacion, 315, startY + 70, { width: 245, align: 'left' });

        // Gran recuadro gris para las fotografías
        const photoAreaY = startY + 145;
        const photoAreaX = 30;
        const photoAreaWidth = doc.page.width - 60;
        const photoAreaHeight = 520; // Ajustada la altura para que quepa bien
        doc.rect(photoAreaX, photoAreaY, photoAreaWidth, photoAreaHeight).fillAndStroke('white', '#000000');
        doc.fontSize(14).font('Helvetica-Bold').fillColor('#555555').text('INSERTAR FOTOGRAFÍAS', photoAreaX, photoAreaY + 20, { align: 'center' });

        // Posicionamiento de imágenes dentro del recuadro
        const imgWidth = (photoAreaWidth - 30) / 2;
        const imgHeight = imgWidth * 0.75;
        const imgStartX = photoAreaX + 10;
        const imgStartY = photoAreaY + 50;
        const imgMargin = 10;

        const drawImage = (file, x, y) => {
            if (file) {
                try {
                    doc.image(file.content, x, y, { fit: [imgWidth, imgHeight], align: 'center', valign: 'center' });
                } catch (imgError) {
                    console.error("Error incrustando imagen:", imgError.message);
                }
            }
        };

        drawImage(files.fotoParDelantero, imgStartX, imgStartY);
        drawImage(files.fotoParTrasero, imgStartX + imgWidth + imgMargin, imgStartY);
        drawImage(files.fotoDetalle, imgStartX, imgStartY + imgHeight + imgMargin);
        drawImage(files.fotoEtiqueta, imgStartX + imgWidth + imgMargin, imgStartY + imgHeight + imgMargin);

        doc.end();
    });
}
// --- FIN DE LA REESCRITURA DEL PDF ---

exports.handler = async function (event, context) {
    try {
        const { fields: data, files } = await parseMultipartForm(event);
        const pdfBytes = await generatePdf(data, files);
        const pdfBase64 = pdfBytes.toString('base64');
        const fileName = `Garantia_Upower_${data.cliente.replace(/ /g, '_')}_${data.fecha}.pdf`;

        const msg = {
            to: 'nacho@representacionesarroyo.es',
            from: 'pablo2vbngdaw@gmail.com',
            subject: `Nueva Garantía U-Power de: ${data.cliente}`,
            text: `Se ha recibido una nueva solicitud de garantía. Los detalles están en el PDF adjunto.\n\nCliente: ${data.cliente}\nContacto: ${data.contacto}`,
            attachments: [{ content: pdfBase64, filename: fileName, type: 'application/pdf', disposition: 'attachment' }],
        };
        if (data.email && data.email.includes('@')) {
            msg.cc = data.email;
        }

        await sgMail.send(msg);

        return { statusCode: 200, body: JSON.stringify({ success: true, message: 'Garantía enviada con éxito' }) };
    } catch (error) {
        console.error('Error en la función:', error.toString());
        return { statusCode: 500, body: JSON.stringify({ success: false, message: `Error en el servidor: ${error.message}` }) };
    }
};